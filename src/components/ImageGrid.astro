---
interface ImageItem {
  src: string;
  alt?: string;
  title?: string;
  description?: string;
  href?: string;
}

interface Props {
  items?: ImageItem[];
  columns?: {
    base?: 1 | 2 | 3 | 4;
    md?: 1 | 2 | 3 | 4;
    lg?: 1 | 2 | 3 | 4;
  };
}

const {
  items = [],
  columns = {
    base: 1,
    md: 2,
    lg: 3,
  },
} = Astro.props as Props;

const gridClassList = ["grid", "gap-6"] as string[];

if (columns.base === 1) gridClassList.push("grid-cols-1");
if (columns.base === 2) gridClassList.push("grid-cols-2");
if (columns.base === 3) gridClassList.push("grid-cols-3");
if (columns.base === 4) gridClassList.push("grid-cols-4");

if (columns.md === 1) gridClassList.push("md:grid-cols-1");
if (columns.md === 2) gridClassList.push("md:grid-cols-2");
if (columns.md === 3) gridClassList.push("md:grid-cols-3");
if (columns.md === 4) gridClassList.push("md:grid-cols-4");

if (columns.lg === 1) gridClassList.push("lg:grid-cols-1");
if (columns.lg === 2) gridClassList.push("lg:grid-cols-2");
if (columns.lg === 3) gridClassList.push("lg:grid-cols-3");
if (columns.lg === 4) gridClassList.push("lg:grid-cols-4");

const gridClass = gridClassList.join(" ");
---

<section class={gridClass}>
  {
    items.map((item) => {
      const Wrapper = item.href ? "a" : "div";
      return (
        <Wrapper
          href={item.href}
          class="group block h-full"
          target={item.href ? "_blank" : undefined}
          rel={item.href ? "noopener noreferrer" : undefined}
        >
          <div class="flex aspect-square w-full items-center justify-center overflow-hidden bg-black/5">
            <img
              src={item.src}
              alt={item.alt ?? ""}
              class="max-h-full max-w-full object-contain transition duration-300 group-hover:scale-[1.02]"
              loading="lazy"
            />
          </div>
          {(item.title || item.description) && (
            <div class="mt-3 space-y-2 text-black">
              <hr class="border-white/10" />
              {item.title && (
                <h3 class="text-lg leading-tight font-semibold">
                  {item.title}
                </h3>
              )}
              {item.description && (
                <p class="text-sm leading-relaxed text-gray-700">
                  {item.description}
                </p>
              )}
            </div>
          )}
        </Wrapper>
      );
    })
  }
</section>
